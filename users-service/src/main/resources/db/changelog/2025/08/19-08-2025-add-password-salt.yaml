databaseChangeLog:
  - changeSet:
      id: 19-08-2025-add-password-salt
      author: your-name
      changes:
        # Шаг 1: Добавляем колонку, разрешая NULL
        - addColumn:
            tableName: users
            columns:
              - column:
                  name: password_salt
                  type: VARCHAR(255)

  - changeSet:
      id: 19-08-2025-update-existing-users-password-salt
      author: your-name
      changes:
        # Шаг 2: Обновляем старые записи. Устанавливаем временное значение
        - sql:
            dbms: postgresql
            sql: UPDATE users SET password_salt = '' WHERE password_salt IS NULL;

  - changeSet:
      id: 19-08-2025-make-password-salt-not-null
      author: your-name
      changes:
        # Шаг 3: Изменяем колонку, делая ее NOT NULL с помощью нативного SQL
        - sql:
            dbms: postgresql
            sql: ALTER TABLE users ALTER COLUMN password_salt SET NOT NULL;